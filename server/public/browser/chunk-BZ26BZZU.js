import{a as H,b as U}from"./chunk-SRH32LXR.js";import{a as q,b as J}from"./chunk-EBYKPA7G.js";import{d as Q}from"./chunk-B7NH7COA.js";import"./chunk-ZIXO3TMD.js";import"./chunk-I5SXR335.js";import"./chunk-LDSH5ZEA.js";import{a as b,d as A,i as N,k as T,n as R,o as B,p as G,q as W,s as V}from"./chunk-EUUJERWT.js";import"./chunk-IVREERM6.js";import{d as K}from"./chunk-ALHQIKHA.js";import{$a as O,Fa as u,Ja as S,La as g,Ma as P,Pb as L,Sb as I,Uc as D,Va as a,Wa as i,Y as h,Z as x,bd as F,cb as v,cd as k,eb as f,gd as Y,hd as j,id as z,ob as r,pb as c,qa as e,qb as y,rb as M,sb as C,tb as _,ua as w,yb as l,za as E,zb as d}from"./chunk-PQW76BEZ.js";function Z(n,o){n&1&&(a(0,"span"),r(1),l(2,"translate"),i()),n&2&&(e(),c(d(2,1,"COMMON.SAVE")))}function $(n,o){n&1&&(a(0,"span"),r(1),l(2,"translate"),i()),n&2&&(e(),c(d(2,1,"COMMON.SAVING")))}function ee(n,o){if(n&1){let t=O();a(0,"div",32)(1,"button",33),v("click",function(){h(t);let m=f();return x(m.saveAutoLogoff())}),u(2,Z,3,3,"span",34)(3,$,3,3,"span",34),i()()}if(n&2){let t=f();e(),g("variant",t.variantValue)("disabled",t.isAutoLogoffSaving),e(),g("ngIf",!t.isAutoLogoffSaving),e(),g("ngIf",t.isAutoLogoffSaving)}}function te(n,o){if(n&1&&(a(0,"span",35),l(1,"translate"),r(2),i()),n&2){let t=f();P("color",t.autoLogoffMessage===d(1,3,"MANAGEMENT.AUTO_LOGOFF.SAVED")?"green":"red"),e(2),c(t.autoLogoffMessage)}}function ne(n,o){n&1&&(a(0,"span"),r(1),l(2,"translate"),i()),n&2&&(e(),c(d(2,1,"COMMON.CONFIRM")))}function ie(n,o){n&1&&(a(0,"span"),r(1),l(2,"translate"),i()),n&2&&(e(),c(d(2,1,"COMMON.SAVING")))}function ae(n,o){if(n&1){let t=O();a(0,"div",32)(1,"button",33),v("click",function(){h(t);let m=f();return x(m.savePasswordCycle())}),u(2,ne,3,3,"span",34)(3,ie,3,3,"span",34),i()()}if(n&2){let t=f();e(),g("variant",t.variantValue)("disabled",t.isCycleSaving),e(),g("ngIf",!t.isCycleSaving),e(),g("ngIf",t.isCycleSaving)}}function oe(n,o){if(n&1&&(a(0,"span",36),r(1),i()),n&2){let t=f();e(),c(t.cycleErrorMessage)}}function se(n,o){if(n&1&&(a(0,"span",37),r(1),i()),n&2){let t=f();e(),c(t.cycleSuccessMessage)}}function re(n,o){n&1&&(a(0,"span"),r(1),l(2,"translate"),i()),n&2&&(e(),c(d(2,1,"COMMON.CONFIRM")))}function le(n,o){n&1&&(a(0,"span"),r(1),l(2,"translate"),i()),n&2&&(e(),c(d(2,1,"COMMON.SUBMITTING")))}function de(n,o){if(n&1){let t=O();a(0,"div",32)(1,"button",33),v("click",function(){h(t);let m=f();return x(m.changePassword())}),u(2,re,3,3,"span",34)(3,le,3,3,"span",34),i()()}if(n&2){let t=f();e(),g("variant",t.variantValue)("disabled",t.isPasswordSaving),e(),g("ngIf",!t.isPasswordSaving),e(),g("ngIf",t.isPasswordSaving)}}function ce(n,o){if(n&1&&(a(0,"span",36),r(1),i()),n&2){let t=f();e(),c(t.passwordErrorMessage)}}function pe(n,o){if(n&1&&(a(0,"span",37),r(1),i()),n&2){let t=f();e(),c(t.passwordSuccessMessage)}}var X=class n{constructor(o,t,s){this.securityService=o;this.translate=t;this.idle=s}variantValue=F.HIGHLIGHT;autoLogoffSelect="Never";autoLogoffMinutes=0;autoLogoffMessage="";isAutoLogoffSaving=!1;oldPassword="";newPassword="";confirmPassword="";isPasswordSaving=!1;passwordErrorMessage="";passwordSuccessMessage="";selectedCycle="Never";isCycleSaving=!1;cycleErrorMessage="";cycleSuccessMessage="";ngOnInit(){this.loadAutoLogoff(),this.loadPasswordCycle()}loadAutoLogoff(){try{let o=localStorage.getItem("autoLogoffMinutes"),t=o==null?0:Number(o);Number.isFinite(t)&&t>0?(this.autoLogoffSelect="Custom",this.autoLogoffMinutes=Math.floor(t)):(this.autoLogoffSelect="Never",this.autoLogoffMinutes=0),this.idle.update(this.autoLogoffMinutes)}catch{this.autoLogoffSelect="Never",this.autoLogoffMinutes=0,this.idle.update(0)}}saveAutoLogoff(){this.autoLogoffMessage="",this.isAutoLogoffSaving=!0;let o=0;if(this.autoLogoffSelect==="Custom"){if(o=Number(this.autoLogoffMinutes),!Number.isFinite(o)||o<=0||o>60){this.isAutoLogoffSaving=!1,this.autoLogoffMessage=this.translate.instant("MANAGEMENT.AUTO_LOGOFF.ERROR_INVALID_MINUTES");return}o=Math.floor(o)}try{localStorage.setItem("autoLogoffMinutes",String(o))}catch{}this.idle.update(o),this.isAutoLogoffSaving=!1,this.autoLogoffMessage=this.translate.instant("MANAGEMENT.AUTO_LOGOFF.SAVED")}onAutoLogoffSelectChange(){this.autoLogoffSelect==="Never"&&(this.autoLogoffMinutes=0)}loadPasswordCycle(){this.securityService.getPasswordCycle().subscribe({next:o=>{o&&o.success&&o.cycle&&(this.selectedCycle=o.cycle)},error:()=>{}})}savePasswordCycle(){if(this.cycleErrorMessage="",this.cycleSuccessMessage="",!["-1","1m","2m","6m","1y"].includes(this.selectedCycle)){this.cycleErrorMessage=this.translate.instant("MSG.ExpirationCycleINVALID");return}this.isCycleSaving=!0,this.securityService.setPasswordCycle(this.selectedCycle).subscribe({next:t=>{t&&t.success?this.cycleSuccessMessage=this.translate.instant("MSG.ExpirationCycleSaveSuccess"):this.cycleErrorMessage=this.translate.instant("MSG.ExpirationCycleSaveFail"),this.isCycleSaving=!1},error:t=>{let s=this.translate.instant("COMMON.ERROR_NETWORK");this.cycleErrorMessage=t?.error?.message||(s&&s!=="COMMON.ERROR_NETWORK"?s:"Failed to connect to server"),this.isCycleSaving=!1}})}changePassword(){if(this.passwordErrorMessage="",this.passwordSuccessMessage="",!this.oldPassword||!this.newPassword||!this.confirmPassword){this.passwordErrorMessage=this.translate.instant("MSG.PasswordInvalid");return}if(this.newPassword.length<8){this.passwordErrorMessage=this.translate.instant("MSG.LengthNotEnough");return}if(this.newPassword===this.oldPassword){this.passwordErrorMessage=this.translate.instant("MSG.SamePassword");return}if(this.newPassword!==this.confirmPassword){this.passwordErrorMessage=this.translate.instant("MSG.PasswordMismatch");return}this.isPasswordSaving=!0,this.securityService.changePassword(this.oldPassword,this.newPassword).subscribe({next:o=>{o.success?(this.passwordSuccessMessage=this.translate.instant("MSG.PasswordChangeSuccess"),this.oldPassword="",this.newPassword="",this.confirmPassword=""):this.passwordErrorMessage=this.translate.instant("MSG.PasswordChangeFailed"),this.isPasswordSaving=!1},error:o=>{let t=o?.error?.message;this.passwordErrorMessage=typeof t=="string"?this.translate.instant(t):this.translate.instant("COMMON.ERROR_NETWORK"),this.isPasswordSaving=!1}})}static \u0275fac=function(t){return new(t||n)(w(J),w(Y),w(Q))};static \u0275cmp=E({type:n,selectors:[["app-management"]],decls:93,vars:77,consts:[[1,"network-config"],[1,"config-section"],["size","large"],[1,"config-grid"],[1,"column"],[1,"config-card"],[1,"card-header"],["class","card-actions",4,"ngIf"],[1,"card-content"],[1,"edit-mode"],[1,"config-item"],["for","autoLogoffSelect"],[2,"display","flex","gap","12px","align-items","center"],["name","autoLogoffSelect","id","autoLogoffSelect",2,"width","max-content","min-width","220px","max-width","100%",3,"optionSelected","ngModelChange","ngModel"],[3,"value"],["type","number","min","1","step","1",2,"width","120px",3,"ngModelChange","ngModel","disabled"],["class","hint",3,"color",4,"ngIf"],["for","passwordCycle"],["id","passwordCycle",3,"ngModelChange","ngModel"],["value","-1"],["value","1m"],["value","2m"],["value","6m"],["value","1y"],["class","hint","style","color: red;",4,"ngIf"],["class","hint","style","color: green;",4,"ngIf"],["for","oldPassword"],["type","password","id","oldPassword",3,"ngModelChange","ngModel"],["for","newPassword"],["type","password","id","newPassword",3,"ngModelChange","ngModel"],["for","confirmPassword"],["type","password","id","confirmPassword",3,"ngModelChange","ngModel"],[1,"card-actions"],["odxButton","",3,"click","variant","disabled"],[4,"ngIf"],[1,"hint"],[1,"hint",2,"color","red"],[1,"hint",2,"color","green"]],template:function(t,s){t&1&&(a(0,"div",0)(1,"div",1)(2,"odx-area-header",2),r(3),l(4,"translate"),i(),a(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"h3"),r(10),l(11,"translate"),i(),u(12,ee,4,4,"div",7),i(),a(13,"div",8)(14,"div",9)(15,"div",10)(16,"label",11),r(17),l(18,"translate"),i(),a(19,"div",12)(20,"odx-select",13),v("optionSelected",function(){return s.onAutoLogoffSelectChange()}),_("ngModelChange",function(p){return C(s.autoLogoffSelect,p)||(s.autoLogoffSelect=p),p}),a(21,"odx-select-option",14),r(22),l(23,"translate"),i(),a(24,"odx-select-option",14),r(25),l(26,"translate"),i()()(),a(27,"div",12)(28,"input",15),l(29,"translate"),_("ngModelChange",function(p){return C(s.autoLogoffMinutes,p)||(s.autoLogoffMinutes=p),p}),i()(),u(30,te,3,5,"span",16),i()()()()(),a(31,"div",4)(32,"div",5)(33,"div",6)(34,"h3"),r(35),l(36,"translate"),i(),u(37,ae,4,4,"div",7),i(),a(38,"div",8)(39,"div",9)(40,"div",10)(41,"label",17),r(42),l(43,"translate"),i(),a(44,"select",18),_("ngModelChange",function(p){return C(s.selectedCycle,p)||(s.selectedCycle=p),p}),a(45,"option",19),r(46),l(47,"translate"),i(),a(48,"option",20),r(49),l(50,"translate"),i(),a(51,"option",21),r(52),l(53,"translate"),i(),a(54,"option",22),r(55),l(56,"translate"),i(),a(57,"option",23),r(58),l(59,"translate"),i()()(),a(60,"div",10),u(61,oe,2,1,"span",24)(62,se,2,1,"span",25),i()()()()(),a(63,"div",4)(64,"div",5)(65,"div",6)(66,"h3"),r(67),l(68,"translate"),i(),u(69,de,4,4,"div",7),i(),a(70,"div",8)(71,"div",9)(72,"div",10)(73,"label",26),r(74),l(75,"translate"),i(),a(76,"input",27),l(77,"translate"),_("ngModelChange",function(p){return C(s.oldPassword,p)||(s.oldPassword=p),p}),i()(),a(78,"div",10)(79,"label",28),r(80),l(81,"translate"),i(),a(82,"input",29),l(83,"translate"),_("ngModelChange",function(p){return C(s.newPassword,p)||(s.newPassword=p),p}),i()(),a(84,"div",10)(85,"label",30),r(86),l(87,"translate"),i(),a(88,"input",31),l(89,"translate"),_("ngModelChange",function(p){return C(s.confirmPassword,p)||(s.confirmPassword=p),p}),i()(),a(90,"div",10),u(91,ce,2,1,"span",24)(92,pe,2,1,"span",25),i()()()()()()()()),t&2&&(e(3),y(" ",d(4,37,"APP.NAV.MANAGEMENT")," "),e(7),c(d(11,39,"MANAGEMENT.AUTO_LOGOFF.TITLE")),e(2),g("ngIf",!s.isAutoLogoffSaving),e(5),c(d(18,41,"MANAGEMENT.AUTO_LOGOFF.SELECT_LABEL")),e(3),M("ngModel",s.autoLogoffSelect),e(),g("value","Never"),e(),c(d(23,43,"MANAGEMENT.AUTO_LOGOFF.OPTIONS.NEVER")),e(2),g("value","Custom"),e(),c(d(26,45,"MANAGEMENT.AUTO_LOGOFF.OPTIONS.CUSTOM")),e(3),M("ngModel",s.autoLogoffMinutes),g("disabled",s.autoLogoffSelect!=="Custom"),S("placeholder",d(29,47,"MANAGEMENT.AUTO_LOGOFF.MINUTES_PLACEHOLDER")),e(2),g("ngIf",s.autoLogoffMessage),e(5),c(d(36,49,"PASSWORD.CYCLE.TITLE")),e(2),g("ngIf",!s.isCycleSaving),e(5),c(d(43,51,"PASSWORD.CYCLE.SELECT_LABEL")),e(2),M("ngModel",s.selectedCycle),e(2),c(d(47,53,"PASSWORD.CYCLE.OPTIONS.NEVER")),e(3),c(d(50,55,"PASSWORD.CYCLE.OPTIONS.1M")),e(3),c(d(53,57,"PASSWORD.CYCLE.OPTIONS.2M")),e(3),c(d(56,59,"PASSWORD.CYCLE.OPTIONS.6M")),e(3),c(d(59,61,"PASSWORD.CYCLE.OPTIONS.1Y")),e(3),g("ngIf",s.cycleErrorMessage),e(),g("ngIf",s.cycleSuccessMessage),e(5),c(d(68,63,"PASSWORD.CHANGE.TITLE")),e(2),g("ngIf",!s.isPasswordSaving),e(5),c(d(75,65,"PASSWORD.CHANGE.CURRENT_LABEL")),e(2),M("ngModel",s.oldPassword),S("placeholder",d(77,67,"PASSWORD.CHANGE.CURRENT_PLACEHOLDER")),e(4),c(d(81,69,"PASSWORD.CHANGE.NEW_LABEL")),e(2),M("ngModel",s.newPassword),S("placeholder",d(83,71,"PASSWORD.CHANGE.NEW_PLACEHOLDER")),e(4),c(d(87,73,"PASSWORD.CHANGE.CONFIRM_LABEL")),e(2),M("ngModel",s.confirmPassword),S("placeholder",d(89,75,"PASSWORD.CHANGE.CONFIRM_PLACEHOLDER")),e(3),g("ngIf",s.passwordErrorMessage),e(),g("ngIf",s.passwordSuccessMessage))},dependencies:[I,L,V,B,G,b,T,R,A,W,N,q,D,K,k,z,j,U,H],styles:[".network-config[_ngcontent-%COMP%]{background:#f5f7fa;padding:20px;height:100vh;overflow:auto}.config-section[_ngcontent-%COMP%]{margin-bottom:30px}.config-card[_ngcontent-%COMP%]{background:#fff;border-radius:4px;box-shadow:0 2px 4px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#f8f9fa;border-bottom:1px solid #eee}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500;flex:1 1 auto;min-width:0;overflow:hidden}.card-header[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{flex:0 0 auto;margin-left:12px}.card-content[_ngcontent-%COMP%]{padding:20px}.config-item[_ngcontent-%COMP%]{margin-bottom:15px}.view-mode[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]{display:flex;margin-bottom:10px}.view-mode[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{width:150px;color:#666}.view-mode[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:500}.status-ok[_ngcontent-%COMP%]{color:#2ecc71}.edit-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:500}.edit-mode[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;margin-bottom:5px}.edit-mode[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background-color:#f5f5f5;cursor:not-allowed}.hint[_ngcontent-%COMP%]{display:block;font-size:12px;color:#888;margin-top:5px}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.cancel-button[_ngcontent-%COMP%], .save-button[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;cursor:pointer;font-size:14px;margin-left:10px}.cancel-button[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333}.cancel-button[_ngcontent-%COMP%]:hover{background-color:#d0d0d0}.save-button[_ngcontent-%COMP%]{background-color:#2ecc71;color:#fff}.save-button[_ngcontent-%COMP%]:hover{background-color:#27ae60}.save-button[_ngcontent-%COMP%]:disabled, .cancel-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.card-separator[_ngcontent-%COMP%]{height:1px;background-color:#e0e0e0;margin:20px 0;box-shadow:0 1px 2px #0000000d}.config-grid[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:flex-start}.config-grid[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{flex:1 1 0;min-width:400px;display:flex;flex-direction:column;gap:20px}@media (max-width: 900px){.config-grid[_ngcontent-%COMP%]{flex-direction:column}}.config-header-row[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:flex-end;justify-content:space-between;margin-bottom:20px}.config-header-row[_ngcontent-%COMP%]   .header-col[_ngcontent-%COMP%]{flex:1 1 0}@media (max-width: 900px){.config-header-row[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}"]})};export{X as ManagementComponent};
