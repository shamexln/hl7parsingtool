import{A as s,K as r,O as g,R as b,Tb as h,j as u,o as n,s as i}from"./chunk-43CMOHO6.js";var c=class a{constructor(e){this.http=e}_isLoggedIn$=new u(!1);_token$=new u(null);get isLoggedIn$(){return this._isLoggedIn$.asObservable()}get isLoggedIn(){return this._isLoggedIn$.value}get token$(){return this._token$.asObservable()}get token(){return this._token$.value}setupRequired(){return this.http.get("/api/auth/setup-required").pipe(i(e=>!!e?.setupRequired),s(()=>n(!1)))}setupInitial(e,o,l){return this.http.post("/api/auth/setup-initial",{username:e,password:o,confirmPassword:l}).pipe(i(t=>t?.success===!0),s(()=>n(!1)))}login(e,o){let l={username:e,password:o};return this.http.post("/api/auth/login",l).pipe(i(t=>t?.token?t.token:null),r(t=>{let p=typeof t=="string"&&t.length>0;this._token$.next(p?t:null),this._isLoggedIn$.next(p)}),i(t=>!!t),s(()=>(this._token$.next(null),this._isLoggedIn$.next(!1),n(!1))))}checkSession(){return this.http.get("/api/auth/me").pipe(i(e=>!!e?.authenticated),r(e=>this._isLoggedIn$.next(e)),s(()=>(this._isLoggedIn$.next(!1),n(!1))))}logout(){return this.http.post("/api/auth/logout",{}).pipe(s(()=>n(void 0)),r(()=>{this._token$.next(null),this._isLoggedIn$.next(!1)}))}static \u0275fac=function(o){return new(o||a)(b(h))};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};export{c as a};
