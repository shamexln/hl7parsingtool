import{$ as m,D as C,Ga as w,Gb as O,Hb as V,Ib as S,Ic as p,O as x,Q as l,S as s,U as b,W as D,a as r,b as c,dc as R,jc as h,kc as N,lc as y,mc as M,pa as j,q as u,ua as I,xa as E,xc as H,za as T}from"./chunk-43CMOHO6.js";var A=(()=>{class n{constructor(){this.element=H(),this.currentSubscription=null}set content(e){u(e)?(this.ngOnDestroy(),this.currentSubscription=e.pipe(C()).subscribe(t=>{this.setContent(t)})):this.setContent(e)}ngOnDestroy(){this.currentSubscription?.unsubscribe(),this.currentSubscription=null}setContent(e){this.element.nativeElement.innerHTML=e}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=E({type:n,selectors:[["odx-dynamic-view"]],inputs:{content:"content"},decls:0,vars:0,template:function(t,o){},encapsulation:2,changeDetection:0})}}return n})();function U(n,i){let e=V(n);return e&&e.ngContentSelectors.length>0?e.ngContentSelectors.map(t=>t==="*"?i:[]):[]}function g(n){return M(n)||u(n)}var d=class{constructor(i){this.options=i,this.application=this.options.injector.get(w),this.componentRef=null,this.componentInputs=null;let{component:e,context:t,injector:o,projectableNodes:k,host:a}=i;this.componentRef=O(e,{environmentInjector:o.get(b),elementInjector:o,projectableNodes:k}),this.componentInputs=V(this.componentRef.componentType)?.inputs.reduce((v,{propName:F})=>(v[F]=!0,v),{})??null,h(a)?a.insert(this.componentRef.hostView):(this.application.attachView(this.componentRef.hostView),a&&a.appendChild(this.getElement())),t&&this.update(t)}detectChanges(){this.componentRef?.changeDetectorRef.detectChanges()}destroy(){if(this.componentRef?.hostView.destroyed){this.componentRef=null;return}this.componentRef&&!h(this.options.host)&&this.application.detachView(this.componentRef.hostView),this.componentRef?.destroy(),this.componentRef=null,this.componentInputs=null}getElement(){return this.componentRef?.location.nativeElement??null}update(i){if(this.options.context=R({},this.options.context,i),!!this.componentRef)for(let e in this.options.context)this.componentInputs?.[e]&&this.componentRef.setInput(e,this.options.context[e])}getContext(){return this.options.context??{}}getView(){return this.componentRef?.hostView??null}},f=class{constructor(i){this.options=i,this.application=this.options.injector.get(w),this.embeddedViewRef=null,this.create(i)}detectChanges(){this.embeddedViewRef?.detectChanges()}destroy(){if(this.embeddedViewRef?.destroyed){this.embeddedViewRef=null;return}!h(this.options.host)&&this.embeddedViewRef&&this.application.detachView(this.embeddedViewRef),this.embeddedViewRef?.destroy(),this.embeddedViewRef=null}getElement(){return this.embeddedViewRef?.rootNodes?.[0]??null}update(i){this.options.context=R({},this.options.context,i),this.embeddedViewRef&&(this.embeddedViewRef.context=this.options.context,this.detectChanges())}getContext(){return this.options.context??{}}getView(){return this.embeddedViewRef}create({context:i,template:e,host:t}){h(t)?this.embeddedViewRef=t.createEmbeddedView(e,i,{injector:this.options.injector}):(this.embeddedViewRef=e.createEmbeddedView(i??{},this.options.injector),this.application.attachView(this.embeddedViewRef))}};function _(n){return n instanceof d||n instanceof f}var L=new l("@odx/angular/cdk/dynamic-view::DynamicViewContext"),W=new l("@odx/angular/cdk/dynamic-view::DynamicViewDefaultHost",{providedIn:"root",factory:()=>s(S).body});function X(){return s(W)}var Y=(()=>{class n{constructor(){this.injector=s(m),this.defaultHost=X()}createView(e,t={}){let o=c(r({},t),{host:t.host??this.defaultHost,injector:m.create({providers:[{provide:L,useValue:t.context},t.providers??[]],parent:t.injector??this.injector})});if(N(e))return new f(c(r({},o),{template:e}));if(y(e))return new d(c(r({},o),{context:t.context,component:e}));if(g(e))return new d(c(r({},o),{component:A,context:{content:e}}));throw new Error("Content type is not supported")}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=x({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ne=(()=>{class n{constructor(){this.dynamicViewService=s(Y),this.viewContainer=s(I),this.template=s(j),this.viewRef=null,this.contentViewRef=null,this.content=null}ngOnInit(){this.render()}ngOnChanges(e){if(p(e,"injector")&&this.render(),p(e,"content")){let t=g(e.content?.previousValue)&&g(e.content?.currentValue);this.render(!t)}p(e,"context")&&this.viewRef?.update(e.context?.currentValue??{})}ngOnDestroy(){this.destroy()}getView(){return this.viewRef}render(e=!0){if(!this.content){this.destroy();return}if(!e&&this.viewRef){this.viewRef?.update({content:this.content});return}if(this.viewRef?.destroy(),_(this.content)){this.viewRef=this.content;let t=this.viewRef.getView();t&&this.viewContainer.insert(t)}else{let t=[];if(y(this.content)){this.contentViewRef=this.dynamicViewService.createView(this.template,{injector:this.injector});let o=this.contentViewRef.getView().rootNodes;t=U(this.content,o)}this.viewRef=this.dynamicViewService.createView(this.content,{context:this.context??void 0,injector:this.injector??this.viewContainer.injector,projectableNodes:t,host:this.viewContainer})}}destroy(){this.contentViewRef?.destroy(),this.viewRef?.destroy(),this.contentViewRef=null,this.viewRef=null}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275dir=T({type:n,selectors:[["ng-template","odxDynamicView",""]],inputs:{content:[0,"odxDynamicView","content"],injector:[0,"odxDynamicViewInjector","injector"],context:[0,"odxDynamicViewContext","context"]},features:[D]})}}return n})();export{Y as a,ne as b};
