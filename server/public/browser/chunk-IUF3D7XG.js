import{a as X,b as nt}from"./chunk-EBYKPA7G.js";import{d as ot}from"./chunk-B7NH7COA.js";import"./chunk-ZIXO3TMD.js";import"./chunk-I5SXR335.js";import{a as J,b as Y,c as Z,d as $,e as tt,f as et,g as it}from"./chunk-DQ6KATE4.js";import{a as A,d as F,i as G,s as W}from"./chunk-EUUJERWT.js";import"./chunk-IVREERM6.js";import{d as q}from"./chunk-ALHQIKHA.js";import{$a as M,Bb as V,Fa as v,Ja as S,La as d,P as N,Pb as B,S as T,Sb as k,Uc as z,Va as a,Wa as o,Xa as O,Y as u,Yb as D,Z as C,bd as L,cb as _,cd as j,eb as m,gd as K,hd as U,ib as y,id as Q,jb as w,kb as H,ob as r,pb as c,qa as e,qb as f,rb as b,sb as P,tb as I,ua as h,yb as s,za as R,zb as p}from"./chunk-PQW76BEZ.js";var E=class i{constructor(n){this.http=n}getPortConfig(){return this.http.get("/api/port-config")}updateTcpPort(n){return this.http.post("/api/port-config",{tcpPort:n})}updateHttpPort(n){return this.http.post("/api/port-config",{httpPort:n})}static \u0275fac=function(t){return new(t||i)(T(D))};static \u0275prov=N({token:i,factory:i.\u0275fac,providedIn:"root"})};var pt=["modal"];function lt(i,n){if(i&1){let t=M();a(0,"div",11)(1,"button",12),_("click",function(){u(t);let l=m();return C(l.startHttpEditing())}),r(2),s(3,"translate"),o()()}if(i&2){let t=m();e(),d("variant",t.variantValue),e(),c(p(3,2,"COMMON.EDIT"))}}function dt(i,n){if(i&1&&(a(0,"div",13)(1,"div",14)(2,"span",15),r(3),s(4,"translate"),o(),a(5,"span",16),r(6,"localhost"),o()(),a(7,"div",14)(8,"span",15),r(9),s(10,"translate"),o(),a(11,"span",16),r(12),o()(),a(13,"div",14)(14,"span",15),r(15),s(16,"translate"),o(),a(17,"span",17),r(18),s(19,"translate"),o()()()),i&2){let t=m();e(3),f("",p(4,5,"COMMON.SERVER_ADDRESS"),":"),e(6),f("",p(10,7,"COMMON.PORT"),":"),e(3),c(t.savedHttpPort),e(3),f("",p(16,9,"COMMON.STATUS"),":"),e(3),c(p(19,11,"COMMON.CONNECTED"))}}function ct(i,n){if(i&1&&(a(0,"span",29),r(1),o()),i&2){let t=m(2);e(),c(t.httpErrorMessage)}}function gt(i,n){i&1&&(a(0,"span"),r(1),s(2,"translate"),o()),i&2&&(e(),c(p(2,1,"COMMON.SAVE")))}function mt(i,n){i&1&&(a(0,"span"),r(1),s(2,"translate"),o()),i&2&&(e(),c(p(2,1,"COMMON.SAVING")))}function ft(i,n){if(i&1){let t=M();a(0,"div",18)(1,"div",14)(2,"label",19),r(3),s(4,"translate"),o(),O(5,"input",20),a(6,"span",21),r(7),s(8,"translate"),o()(),a(9,"div",14)(10,"label",22),r(11),s(12,"translate"),o(),a(13,"input",23),s(14,"translate"),I("ngModelChange",function(l){u(t);let x=m();return P(x.httpPort,l)||(x.httpPort=l),C(l)}),o(),v(15,ct,2,1,"span",24),o(),a(16,"div",25)(17,"button",26),_("click",function(){u(t);let l=m();return C(l.cancelHttpEditing())}),r(18),s(19,"translate"),o(),a(20,"button",27),_("click",function(){u(t);let l=m();return C(l.saveHttpPortConfiguration())}),v(21,gt,3,3,"span",28)(22,mt,3,3,"span",28),o()()()}if(i&2){let t=m();e(3),f("",p(4,11,"COMMON.SERVER_ADDRESS"),":"),e(4),c(p(8,13,"CONFIG.SERVER_ADDRESS_HINT")),e(4),f("",p(12,15,"COMMON.PORT"),":"),e(2),b("ngModel",t.httpPort),S("placeholder",p(14,17,"COMMON.ENTER_PORT")),e(2),d("ngIf",t.httpErrorMessage),e(2),d("disabled",t.isHttpSaving),e(),c(p(19,19,"COMMON.CANCEL")),e(2),d("disabled",t.isHttpSaving),e(),d("ngIf",!t.isHttpSaving),e(),d("ngIf",t.isHttpSaving)}}function vt(i,n){if(i&1){let t=M();a(0,"div",11)(1,"button",12),_("click",function(){u(t);let l=m();return C(l.startEditing())}),r(2),s(3,"translate"),o()()}if(i&2){let t=m();e(),d("variant",t.variantValue),e(),c(p(3,2,"COMMON.EDIT"))}}function ut(i,n){if(i&1&&(a(0,"div",13)(1,"div",14)(2,"span",15),r(3),s(4,"translate"),o(),a(5,"span",16),r(6,"localhost"),o()(),a(7,"div",14)(8,"span",15),r(9),s(10,"translate"),o(),a(11,"span",16),r(12),o()(),a(13,"div",14)(14,"span",15),r(15),s(16,"translate"),o(),a(17,"span",17),r(18),s(19,"translate"),o()()()),i&2){let t=m();e(3),f("",p(4,5,"COMMON.SERVER_ADDRESS"),":"),e(6),f("",p(10,7,"COMMON.PORT"),":"),e(3),c(t.savedPort),e(3),f("",p(16,9,"COMMON.STATUS"),":"),e(3),c(p(19,11,"COMMON.CONNECTED"))}}function Ct(i,n){if(i&1&&(a(0,"span",29),r(1),o()),i&2){let t=m(2);e(),c(t.errorMessage)}}function xt(i,n){i&1&&(a(0,"span"),r(1),s(2,"translate"),o()),i&2&&(e(),c(p(2,1,"COMMON.SAVE")))}function _t(i,n){i&1&&(a(0,"span"),r(1),s(2,"translate"),o()),i&2&&(e(),c(p(2,1,"COMMON.SAVING")))}function ht(i,n){if(i&1){let t=M();a(0,"div",18)(1,"div",14)(2,"label",30),r(3),s(4,"translate"),o(),O(5,"input",31),a(6,"span",21),r(7),s(8,"translate"),o()(),a(9,"div",14)(10,"label",32),r(11),s(12,"translate"),o(),a(13,"input",33),s(14,"translate"),I("ngModelChange",function(l){u(t);let x=m();return P(x.port,l)||(x.port=l),C(l)}),o(),v(15,Ct,2,1,"span",24),o(),a(16,"div",25)(17,"button",26),_("click",function(){u(t);let l=m();return C(l.cancelEditing())}),r(18),s(19,"translate"),o(),a(20,"button",27),_("click",function(){u(t);let l=m();return C(l.savePortConfiguration())}),v(21,xt,3,3,"span",28)(22,_t,3,3,"span",28),o()()()}if(i&2){let t=m();e(3),f("",p(4,11,"COMMON.SERVER_ADDRESS"),":"),e(4),c(p(8,13,"CONFIG.SERVER_ADDRESS_HINT")),e(4),f("",p(12,15,"COMMON.PORT"),":"),e(2),b("ngModel",t.port),S("placeholder",p(14,17,"COMMON.ENTER_PORT")),e(2),d("ngIf",t.errorMessage),e(2),d("disabled",t.isSaving),e(),c(p(19,19,"COMMON.CANCEL")),e(2),d("disabled",t.isSaving),e(),d("ngIf",!t.isSaving),e(),d("ngIf",t.isSaving)}}function Mt(i,n){if(i&1&&(O(0,"odx-modal-hero",34),a(1,"odx-modal-content")(2,"p")(3,"strong"),r(4),o()()(),a(5,"odx-modal-footer")(6,"button",35),r(7),s(8,"translate"),o()()),i&2){let t=n.$implicit;d("icon",t.data==null?null:t.data.heroIcon)("variant",t.data==null?null:t.data.heroVariant),e(4),c(t.data==null?null:t.data.message),e(3),c(p(8,4,"COMMON.CLOSE"))}}var at=class i{constructor(n,t,g,l){this.configService=n;this.securityService=t;this.translate=g;this.idle=l}variantValue=L.HIGHLIGHT;port="3359";savedPort="3359";isEditing=!1;isSaving=!1;errorMessage="";httpPort="8978";savedHttpPort="8978";isHttpEditing=!1;isHttpSaving=!1;httpErrorMessage="";modal;args;openModalWithData(n,t="info",g="success",l){this.args={data:{message:n,heroIcon:t,heroVariant:g},size:J.XSMALL},this.modal.open();let x=this.modal.modalClose?.subscribe(()=>{x?.unsubscribe(),l&&l()})}ngOnInit(){this.loadPortConfigurations()}loadPortConfigurations(){this.configService.getPortConfig().subscribe({next:n=>{n.success&&(n.config.tcpPort&&(this.port=n.config.tcpPort.toString(),this.savedPort=n.config.tcpPort.toString()),n.config.httpPort&&(this.httpPort=n.config.httpPort.toString(),this.savedHttpPort=n.config.httpPort.toString()))},error:n=>{console.error("Failed to load port configurations:",n)}})}startEditing(){this.isEditing=!0}cancelEditing(){this.port=this.savedPort,this.isEditing=!1,this.errorMessage=""}savePortConfiguration(){if(!this.port||isNaN(Number(this.port))||Number(this.port)<2e3||Number(this.port)>65535){this.errorMessage=this.translate.instant("MSG.InvalidPort");return}this.isSaving=!0,this.errorMessage="",this.configService.updateTcpPort(Number(this.port)).subscribe({next:n=>{if(n.success){this.savedPort=this.port;let t=this.translate.instant("MSG.RestartServiceNotice");this.openModalWithData(t,"info","success",()=>{}),this.isSaving=!1,this.isEditing=!1}else this.errorMessage=this.translate.instant("CONFIG.UpdatePortFail"),this.isSaving=!1},error:n=>{console.error("Error saving port configuration:",n);let t=this.translate.instant("COMMON.ERROR_NETWORK");this.errorMessage=n.error?.message||(t&&t!=="COMMON.ERROR_NETWORK"?t:"Failed to connect to server"),this.isSaving=!1}})}startHttpEditing(){this.isHttpEditing=!0}cancelHttpEditing(){this.httpPort=this.savedHttpPort,this.isHttpEditing=!1,this.httpErrorMessage=""}saveHttpPortConfiguration(){if(!this.httpPort||isNaN(Number(this.httpPort))||Number(this.httpPort)<2e3||Number(this.httpPort)>65535){this.httpErrorMessage=this.translate.instant("MSG.InvalidPort");return}this.isHttpSaving=!0,this.httpErrorMessage="",this.configService.updateHttpPort(Number(this.httpPort)).subscribe({next:n=>{if(n.success){this.savedHttpPort=this.httpPort;let t=this.translate.instant("MSG.RestartServiceNotice");this.openModalWithData(t,"info","success",()=>{}),this.isHttpSaving=!1,this.isHttpEditing=!1}else this.httpErrorMessage=this.translate.instant("MSG.UpdatePortFail"),this.isHttpSaving=!1},error:n=>{console.error("Error saving HTTP port configuration:",n);let t=this.translate.instant("COMMON.ERROR_NETWORK");this.httpErrorMessage=n.error?.message||(t&&t!=="COMMON.ERROR_NETWORK"?t:"Failed to connect to server"),this.isHttpSaving=!1}})}static \u0275fac=function(t){return new(t||i)(h(E),h(nt),h(K),h(ot))};static \u0275cmp=R({type:i,selectors:[["app-configuration"]],viewQuery:function(t,g){if(t&1&&y(pt,7),t&2){let l;w(l=H())&&(g.modal=l.first)}},decls:25,vars:16,consts:[["modal","odxModal"],[1,"network-config"],[1,"config-section"],["size","large"],[1,"config-card"],[1,"card-header"],["class","card-actions",4,"ngIf"],[1,"card-content"],["class","view-mode",4,"ngIf"],["class","edit-mode",4,"ngIf"],[3,"odxModal"],[1,"card-actions"],["odxButton","",3,"click","variant"],[1,"view-mode"],[1,"config-item"],[1,"label"],[1,"value"],[1,"value","status-ok"],[1,"edit-mode"],["for","httpServerAddress"],["type","text","id","httpServerAddress","value","localhost","disabled",""],[1,"hint"],["for","httpPort"],["type","text","id","httpPort",3,"ngModelChange","ngModel"],["class","hint","style","color: red;",4,"ngIf"],[1,"button-group"],[1,"cancel-button",3,"click","disabled"],[1,"save-button",3,"click","disabled"],[4,"ngIf"],[1,"hint",2,"color","red"],["for","serverAddress"],["type","text","id","serverAddress","value","localhost","disabled",""],["for","port"],["type","text","id","port",3,"ngModelChange","ngModel"],[3,"icon","variant"],["odxButton","","variant","primary","odxModalClose",""]],template:function(t,g){t&1&&(a(0,"div",1)(1,"div",2)(2,"odx-area-header",3),r(3),s(4,"translate"),o(),a(5,"div",4)(6,"div",5)(7,"h3"),r(8),s(9,"translate"),o(),v(10,lt,4,4,"div",6),o(),a(11,"div",7),v(12,dt,20,13,"div",8)(13,ft,23,21,"div",9),o()(),a(14,"div",4)(15,"div",5)(16,"h3"),r(17),s(18,"translate"),o(),v(19,vt,4,4,"div",6),o(),a(20,"div",7),v(21,ut,20,13,"div",8)(22,ht,23,21,"div",9),o()(),v(23,Mt,9,6,"ng-template",10,0,V),o()()),t&2&&(e(3),f(" ",p(4,10,"CONFIG.NETWORK_CONFIGURATION")," "),e(5),c(p(9,12,"CONFIG.HTTP_SERVER.TITLE")),e(2),d("ngIf",!g.isHttpEditing),e(2),d("ngIf",!g.isHttpEditing),e(),d("ngIf",g.isHttpEditing),e(4),c(p(18,14,"CONFIG.HL7_RECEIVER.TITLE")),e(2),d("ngIf",!g.isEditing),e(2),d("ngIf",!g.isEditing),e(),d("ngIf",g.isEditing),e(),d("odxModal",g.args))},dependencies:[k,B,W,A,F,G,X,z,q,j,Q,U,it,tt,$,et,Y,Z],styles:[".network-config[_ngcontent-%COMP%]{background:#f5f7fa;padding:20px;height:100vh;overflow:auto}.config-section[_ngcontent-%COMP%]{margin-bottom:30px}.config-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;margin-bottom:20px;font-size:18px;font-weight:500;color:#333}.config-card[_ngcontent-%COMP%]{background:#fff;border-radius:4px;box-shadow:0 2px 4px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#f8f9fa;border-bottom:1px solid #eee}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500}.card-content[_ngcontent-%COMP%]{padding:20px}.config-item[_ngcontent-%COMP%]{margin-bottom:15px}.view-mode[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]{display:flex;margin-bottom:10px}.view-mode[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{width:150px;color:#666}.view-mode[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:500}.status-ok[_ngcontent-%COMP%]{color:#2ecc71}.edit-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:500}.edit-mode[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;margin-bottom:5px}.edit-mode[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background-color:#f5f5f5;cursor:not-allowed}.hint[_ngcontent-%COMP%]{display:block;font-size:12px;color:#888;margin-top:5px}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.cancel-button[_ngcontent-%COMP%], .save-button[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;cursor:pointer;font-size:14px;margin-left:10px}.cancel-button[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333}.cancel-button[_ngcontent-%COMP%]:hover{background-color:#d0d0d0}.save-button[_ngcontent-%COMP%]{background-color:#2ecc71;color:#fff}.save-button[_ngcontent-%COMP%]:hover{background-color:#27ae60}.save-button[_ngcontent-%COMP%]:disabled, .cancel-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.help-section[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:4px;padding:15px}.help-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:15px;font-size:16px;font-weight:500}.help-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:15px;margin-bottom:10px;font-size:14px;font-weight:500}.help-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px;font-size:13px;line-height:1.5;color:#555}.card-separator[_ngcontent-%COMP%]{height:1px;background-color:#e0e0e0;margin:20px 0;box-shadow:0 1px 2px #0000000d}"]})};export{at as ConfigurationComponent};
